\usepackage{fontspec}
\usepackage[fixamsmath]{mathtools}
\usepackage{unicode-math}
\usepackage{amsfonts, amsthm}
\usepackage{parskip}
\usepackage{cancel}
\usepackage{pgfplots}
\pgfplotsset{compat=1.18}
\usetikzlibrary{decorations.markings, calc, arrows.meta, hobby, intersections, decorations.pathreplacing, calligraphy, patterns, patterns.meta, pgfplots.fillbetween}
\usepackage{csquotes}
\usepackage{xparse}
\usepackage[narrowiints]{kpfonts-otf}
\usepackage{physics}
\usepackage[labelfont=bf, textfont=it]{caption}
\usepackage{subcaption}
\usepackage{graphicx}
\usepackage{import}
\usepackage{polyglossia}
\setmainlanguage{english}
\usepackage{enumitem}
\usepackage[inkscapelatex=false]{svg}
\graphicspath{{images/}}
\svgpath{{images/}}
\setlist[enumerate]{label=(\arabic*)}
\setlist[itemize]{label=\ding{226}}

\usepackage[backend=biber, style=alphabetic, sorting=ynt]{biblatex}

\everymath{\displaystyle}
\allowdisplaybreaks[2]

\newcommand{\tikzhalflengtharrow}[2]{%
    \path (#1) -- (#2) coordinate[pos=0.25] (Pstart) coordinate[pos=0.75] (Pend);
    \draw[-{Stealth}, thick, black] (Pstart) -- (Pend);
}
\def\tikzcenterarc(#1)(#2:#3:#4)%(center) (initial:final:radius)
{
    ($(#1)+({#4*cos(#2)},{#4*sin(#2)})$) arc (#2:#3:#4)
}
\newcommand{\tikztemporarygrid}[4]{%
    % #1 = xmin, #2 = xmax, #3 = ymin, #4 = ymax
    \draw[step=1cm, gray!50, very thin] (#1,#3) grid (#2,#4);
    \draw[->, thick] (#1-0.5,0) -- (#2+0.5,0) node[right] {$x$};
    \draw[->, thick] (0,#3-0.5) -- (0,#4+0.5) node[above] {$y$};
}

\tikzset{
    point/.style={
        circle,
        fill,
        inner sep=1pt
    }
}

\newcommand{\ddx}{\dd{x}}
\newcommand{\ddy}{\dd{y}}
\newcommand{\ddz}{\dd{z}}
\newcommand{\ddzeta}{\dd{\zeta}}
\newcommand{\ddt}{\dd{t}}
\newcommand{\supp}{\operatorname{supp}}
\newcommand{\diam}{\operatorname{diam}}
\newcommand{\Log}{\operatorname{Log}}
\newcommand{\Arg}{\operatorname{Arg}}
\newcommand{\Aut}{\operatorname{Aut}}

\usepackage{keytheorems}
\usepackage{hyperref}
\usepackage[noabbrev, nameinlink]{cleveref}

\numberwithin{equation}{subsection}
\numberwithin{figure}{section}
\newkeytheorem{theorem, proposition, lemma}[
    parent=subsection,
    sibling=theorem,
]
\newkeytheorem{corollary}[parent=theorem]
\newkeytheorem{definition,example}[
    style=definition,
    sibling=theorem
]
\newkeytheorem{remark}[
    style=remark,
    numbered=no,
]
\crefname{enumi}{property}{properties}
\Crefname{enumi}{Property}{Properties}
\crefformat{section}{\S#2#1#3}
\crefformat{subsection}{\S#2#1#3}
\crefformat{subsubsection}{\S#2#1#3}
\crefrangeformat{section}{\S\S#3#1#4 to~#5#2#6}
\crefmultiformat{section}{\S\S#2#1#3}{ and~#2#1#3}{, #2#1#3}{ and~#2#1#3}

\DeclarePairedDelimiter{\paren}{(}{)}
\let\parendefault\paren%
\renewcommand{\paren}{\parendefault*}
\DeclarePairedDelimiter{\brackets}{[}{]}
\let\bracketsdefault\brackets%
\renewcommand{\brackets}{\bracketsdefault*}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\let\ceildefault\ceil%
\renewcommand{\ceil}{\ceildefault*}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}
\let\floordefault\floor%
\renewcommand{\floor}{\floordefault*}

\NewDocumentCommand{\cbraces}{m g}{\ensuremath{\left\{#1\IfNoValueTF{#2}{}{:#2}\right\}}}

\renewcommand*{\thefootnote}{\fnsymbol{footnote}}

\newcommand{\extcomplex}{\widehat{\mathbb{C}}}
\newcommand{\ee}{\mathrm{e}}
\newcommand{\ii}{\mathrm{i}}
\newcommand{\interior}[1]{\overset{\circ}{#1}}
\newcommand{\doubletilde}[1]{
    \rlap{\raisebox{0.45ex}{$\widetilde{\phantom{#1{}}}$}}%
    \widetilde{#1{}}
}

\DeclareMathOperator*{\residue}{Res}
\makeatletter
\renewcommand{\@pnumwidth}{1.65em}
\renewcommand{\@tocrmarg}{2.2em}
\makeatother

\setmainfont{KpRoman}[
    Extension      = .otf,
    UprightFont    = *-Regular,
    BoldFont       = *-Bold,
    ItalicFont     = *-Italic,
    BoldItalicFont = *-BoldItalic,
]
\setmathfont{STIXTwoMath-Regular.otf}[Scale=MatchUppercase]
\setmathfont{STIXTwoMath-Regular.otf}[range={scr,bfscr}, StylisticSet=1,Scale=MatchUppercase]
\setmathfont{KpMath-Regular.otf}[range={frak,bffrak}, Scale=MatchUppercase]
\setmathfont{KpMath-Regular.otf}[range={bb,bbit}, Scale=MatchUppercase]
\AtBeginDocument{
    \RenewDocumentCommand{\Re}{}{\mathop{\symfrak{Re}}}
    \RenewDocumentCommand{\Im}{}{\mathop{\symfrak{Im}}}
}
\RenewDocumentCommand{\vu}{m}{\symbf{\hat{#1}}}
\RenewDocumentCommand{\va}{m}{\symbf{\vec{#1}}}

%\usepgfplotslibrary{external}
%\tikzexternalize
